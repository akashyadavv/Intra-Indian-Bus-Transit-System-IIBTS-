USE BUS_RESERVATION;
SELECT FNAME, LNAME
FROM PASSENGER 
WHERE ID IN (SELECT ID FROM TRAVELLER_ITINERARY
WHERE BUS_JOURNEY='h17dec');

SELECT USER_EMAIL, COUNT(NO_OF_PASSENGERS)
FROM BUS_TRIP
WHERE USER_EMAIL IN (SELECT EMAIL
FROM user WHERE TYPE_OF_USER ='NORMAL')
GROUP BY USER_EMAIL;

SELECT * FROM BUS_TRIP INNER JOIN FARE ON
BUS_TRIP.PNR=FARE.PNR;

SELECT FNAME, LNAME,PHONE FROM PASSENGER WHERE ID IN(SELECT ID
FROM TRAVELLER_ITINERARY WHERE BUS_JOURNEY='h17dec')
UNION
SELECT FNAME, LNAME,PHONE FROM PASSENGER WHERE ID IN(SELECT ID FROM
TRAVELLER_ITINERARY WHERE BUS_JOURNEY='i17dec');

SELECT BUS_NO,SEATING_CAPACITY,
Company_name
FROM BUS_company,bus
WHERE company_id = company;

SELECT
USER_EMAIL,
    NO_OF_PASSENGERS,
    DEPART_TIME,
    ARRIVAL_TIME
FROM
BUS_TRIP
WHERE
USER_EMAIL IN
    (
SELECT
EMAIL
FROM
USER
WHERE
TYPE_OF_USER ='NORMAL'
)
GROUP BY
USER_EMAIL;

SELECT
PNR,
    CURRENCY,
    FINAL_AMOUNT AS FINAL_AMOUNT
FROM
FARE
WHERE
PNR IN
    (
SELECT
PNR
FROM
BUS_TRIP
WHERE
ARRIVAL_STATION = 'BLR'
)
ORDER BY
FINAL_AMOUNT DESC;

SELECT
FNAME,
    LNAME
FROM
USER
WHERE
EMAIL IN
    (
SELECT
USER_EMAIL
FROM
BUS_TRIP
WHERE
DEPART_TIME >= '20201001' AND DEPART_TIME < '20201101'
)
ORDER BY FNAME DESC, LNAME DESC;

SELECT
PNR,
    DEPART_STATION AS DEPARTING_STATION,
    ARRIVAL_STATION AS DESTINATION,
    ARRIVAL_TIME AS ARRIVAL
FROM
BUS_TRIP
WHERE
PNR IN
    (
SELECT
PNR
FROM
FARE
WHERE
FINAL_AMOUNT >= 1000
);











